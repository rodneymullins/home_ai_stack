<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The One Dashboard ‚Ä¢ Middle-earth Finance</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Crimson+Text:wght@400;600&display=swap"
        rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --gold: #d4af37;
            --bronze: #cd7f32;
            --dark-brown: #2c1810;
            --parchment: #f4e8d0;
        }

        body {
            font-family: 'Crimson Text', serif;
            background: linear-gradient(135deg, #1a0f0a 0%, #2c1810 50%, #1a0f0a 100%);
            color: var(--parchment);
            min-height: 100vh;
            position: relative;
            padding-bottom: 60px;
        }

        body::after {
            content: 'üíç';
            position: fixed;
            font-size: 400px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity: 0.03;
            pointer-events: none;
            filter: blur(5px);
        }

        .container-fluid {
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        header {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px;
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1), rgba(205, 127, 50, 0.1));
            border: 2px solid var(--gold);
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.3);
        }

        h1 {
            font-family: 'Cinzel', serif;
            font-size: 2.5em;
            font-weight: 900;
            color: var(--gold);
            text-shadow: 0 0 20px rgba(212, 175, 55, 0.8);
            letter-spacing: 4px;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.1em;
            color: var(--bronze);
            font-style: italic;
            letter-spacing: 2px;
        }

        .nav-tabs {
            border-bottom: 2px solid var(--gold);
            margin-bottom: 20px;
        }

        .nav-tabs .nav-link {
            font-family: 'Cinzel', serif;
            color: var(--bronze);
            background: linear-gradient(135deg, rgba(44, 24, 16, 0.6), rgba(26, 15, 10, 0.6));
            border: 2px solid var(--bronze);
            border-bottom: none;
            margin-right: 5px;
            padding: 10px 15px;
            font-weight: 700;
            letter-spacing: 1px;
            transition: all 0.3s;
            font-size: 0.85em;
        }

        .nav-tabs .nav-link:hover {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.2), rgba(205, 127, 50, 0.2));
            color: var(--gold);
            border-color: var(--gold);
        }

        .nav-tabs .nav-link.active {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.3), rgba(205, 127, 50, 0.3));
            color: var(--gold);
            border-color: var(--gold);
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
        }

        .scroll-card {
            background: linear-gradient(135deg, rgba(244, 232, 208, 0.15), rgba(212, 175, 55, 0.1));
            backdrop-filter: blur(10px);
            border: 3px solid var(--gold);
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
            margin-bottom: 20px;
            position: relative;
        }

        .scroll-card::before {
            content: '‚öî';
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 1.5em;
            color: var(--gold);
            opacity: 0.3;
        }

        .card-title {
            font-family: 'Cinzel', serif;
            font-size: 1.3em;
            font-weight: 700;
            color: var(--gold);
            margin-bottom: 15px;
            text-align: center;
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
            border-bottom: 2px solid var(--bronze);
            padding-bottom: 10px;
        }

        .chart-container {
            position: relative;
            height: 200px;
            margin-bottom: 15px;
        }

        .data-item {
            padding: 8px 12px;
            margin: 6px 0;
            background: linear-gradient(90deg, rgba(212, 175, 55, 0.1), rgba(205, 127, 50, 0.05));
            border-left: 3px solid var(--gold);
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.3s;
            cursor: pointer;
            text-decoration: none;
            color: inherit;
        }

        .data-item:hover {
            background: linear-gradient(90deg, rgba(212, 175, 55, 0.3), rgba(205, 127, 50, 0.2));
            transform: translateX(8px);
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.4);
        }

        .rank-badge {
            min-width: 30px;
            height: 30px;
            background: linear-gradient(135deg, var(--gold), var(--bronze));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Cinzel', serif;
            font-size: 0.9em;
            font-weight: 900;
            color: var(--dark-brown);
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.6);
        }

        .trend-text {
            flex: 1;
            font-size: 0.95em;
            color: var(--parchment);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .news-item {
            padding: 15px;
            margin: 10px 0;
            background: linear-gradient(90deg, rgba(212, 175, 55, 0.08), rgba(205, 127, 50, 0.03));
            border-left: 3px solid var(--gold);
            transition: all 0.3s;
        }

        .news-item:hover {
            background: linear-gradient(90deg, rgba(212, 175, 55, 0.15), rgba(205, 127, 50, 0.08));
            transform: translateX(5px);
        }

        .news-title {
            font-size: 1.1em;
            font-weight: 600;
            color: var(--parchment);
            margin-bottom: 5px;
        }

        .news-source {
            font-size: 0.85em;
            color: var(--bronze);
        }

        .service-link {
            display: block;
            padding: 20px;
            margin: 10px 0;
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1), rgba(205, 127, 50, 0.05));
            border: 2px solid var(--gold);
            border-radius: 8px;
            text-decoration: none;
            color: var(--parchment);
            text-align: center;
            transition: all 0.3s;
        }

        .service-link:hover {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.3), rgba(205, 127, 50, 0.2));
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.4);
        }

        .service-name {
            font-family: 'Cinzel', serif;
            font-size: 1.4em;
            font-weight: 700;
            color: var(--gold);
            margin-bottom: 5px;
        }

        .service-url {
            font-size: 0.9em;
            color: rgba(244, 232, 208, 0.7);
        }

        .jackpot-item {
            padding: 12px;
            margin: 8px 0;
            background: linear-gradient(90deg, rgba(212, 175, 55, 0.12), rgba(205, 127, 50, 0.06));
            border-left: 4px solid var(--gold);
            border-radius: 4px;
            transition: all 0.3s;
        }

        .jackpot-item:hover {
            background: linear-gradient(90deg, rgba(212, 175, 55, 0.25), rgba(205, 127, 50, 0.15));
            transform: translateX(5px);
        }

        .jackpot-machine {
            font-size: 1.05em;
            font-weight: 600;
            color: var(--parchment);
            margin-bottom: 5px;
        }

        .jackpot-details {
            font-size: 0.9em;
            color: rgba(244, 232, 208, 0.8);
            display: flex;
            gap: 15px;
        }

        .widget-container {
            background: rgba(244, 232, 208, 0.05);
            border: 2px solid var(--gold);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .widget-container iframe {
            border: none;
            border-radius: 4px;
        }

        .footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 45px;
            background: linear-gradient(135deg, rgba(44, 24, 16, 0.95), rgba(26, 15, 10, 0.95));
            backdrop-filter: blur(10px);
            border-top: 2px solid var(--gold);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 30px;
            font-family: 'Cinzel', serif;
            font-size: 0.85em;
            color: var(--gold);
            z-index: 100;
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <header style="position: relative;">
            <h1>‚öî THE ONE DASHBOARD ‚öî</h1>
            <div class="subtitle">Finance of Middle-earth</div>
            <!-- Smart Search Input -->
            <div style="position: absolute; top: 20px; right: 20px; width: 300px;">
                <input type="text" id="smartSearch" class="form-control" placeholder="üîÆ Ask the Oracle..."
                    style="background: rgba(0,0,0,0.3); border: 1px solid var(--gold); color: var(--gold); font-family: 'Cinzel', serif;">
            </div>
        </header>

        <ul class="nav nav-tabs" role="tablist">
            <li class="nav-item"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#jackpots">üé∞
                    Treasure Hunter</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#links">üó∫Ô∏è
                    Paths</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#trends">üìú
                    Chronicles</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#multicasino">üåç World
                    Watch</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#analytics">üìä
                    Analytics</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#crypto">‚õèÔ∏è
                    Mithril</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#treasury">üí∞
                    Treasures</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#markets">üèõÔ∏è
                    Markets</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#news">üì∞
                    Tidings</button></li>
        </ul>

        <div class="tab-content">
            <!-- Multi-Casino Tab -->
            <div class="tab-pane fade" id="multicasino">
                <div class="row">
                    <div class="col-md-8">
                        <div class="scroll-card">
                            <h2 class="card-title">üì° Live Intelligence Feed</h2>
                            <div style="font-size: 0.8em; color: rgba(244, 232, 208, 0.6); margin-bottom: 15px;">
                                Real-time intercepts from external casino networks</div>
                            {% if multi_casino and multi_casino.latest %}
                            {% for hit in multi_casino.latest %}
                            <div
                                style="padding: 10px; margin: 5px 0; background: linear-gradient(90deg, rgba(32, 201, 151, 0.1), rgba(32, 201, 151, 0.02)); border-left: 3px solid #20c997; display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="color: #20c997; font-weight: bold; font-size: 0.9em;">{{
                                        hit.machine_name }}</div>
                                    <div style="font-size: 0.75em; color: rgba(244, 232, 208, 0.7);">{{ hit.casino }} ‚Ä¢
                                        {{ hit.date_text }}</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="color: var(--gold); font-weight: bold; font-size: 1.1em;">${{
                                        "{:,.2f}".format(hit.amount) }}</div>
                                    <a href="{{ hit.source_url }}" target="_blank"
                                        style="font-size: 0.7em; color: #aaa; text-decoration: none;">Source ‚Üó</a>
                                </div>
                            </div>
                            {% endfor %}
                            {% else %}
                            <div style="text-align: center; color: #777; padding: 20px;">No incoming signals provided.
                            </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="scroll-card">
                            <h2 class="card-title">üèÜ Network Leaderboard</h2>
                            {% if multi_casino and multi_casino.casinos %}
                            {% for casino in multi_casino.casinos %}
                            <div
                                style="padding: 10px; margin-bottom: 10px; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                <div style="color: var(--gold); font-weight: bold;">{{ casino.casino }}</div>
                                <div
                                    style="display: flex; justify-content: space-between; font-size: 0.8em; margin-top: 5px;">
                                    <span>{{ casino.hits }} hits</span>
                                    <span style="color: #20c997;">Avg: ${{ "{:,.0f}".format(casino.avg_payout) }}</span>
                                </div>
                            </div>
                            {% endfor %}
                            {% endif %}

                            <h3 class="card-title" style="margin-top: 30px; font-size: 1.1em;">üî• Top Network Machines
                            </h3>
                            {% if multi_casino and multi_casino.top_machines %}
                            {% for machine in multi_casino.top_machines %}
                            <div style="padding: 8px; margin: 4px 0; background: rgba(0,0,0,0.2);">
                                <div style="color: #fff; font-size: 0.9em;">{{ machine.machine_name }}</div>
                                <div style="font-size: 0.75em; color: #aaa;">Found at: {{ machine.locations }}</div>
                                <div
                                    style="display: flex; justify-content: space-between; font-size: 0.8em; margin-top: 2px;">
                                    <span style="color: var(--bronze);">{{ machine.hits }} hits</span>
                                    <span style="color: var(--gold);">${{ "{:,.0f}".format(machine.avg_payout) }}</span>
                                </div>
                            </div>
                            {% endfor %}
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>


            <!-- Analytics Tab -->
            <div class="tab-pane fade" id="analytics">
                <div class="scroll-card">
                    <h2 class="card-title">üìä Advanced Analytics Dashboard</h2>
                    <p style="text-align: center; color: rgba(244, 232, 208, 0.7); margin-bottom: 30px;">Deep insights
                        into machine performance, player patterns, and market trends</p>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <a href="/transform-data" style="text-decoration: none; color: inherit;">
                                <div
                                    style="padding: 25px; background: linear-gradient(135deg, rgba(212, 175, 55, 0.15), rgba(205, 127, 50, 0.1)); border: 2px solid var(--gold); border-radius: 8px; transition: all 0.3s; cursor: pointer;">
                                    <div style="font-size: 2em; margin-bottom: 10px;">üîÑ</div>
                                    <h3 style="color: var(--gold); font-family: 'Cinzel', serif; margin-bottom: 10px;">
                                        Data Transformation</h3>
                                    <p style="color: rgba(244, 232, 208, 0.8); font-size: 0.9em;">Enrich existing data
                                        with manufacturer classification, game families, and time-based features</p>
                                </div>
                            </a>
                        </div>

                        <div class="col-md-6 mb-3">
                            <a href="/analytics/machine-performance" style="text-decoration: none; color: inherit;">
                                <div
                                    style="padding: 25px; background: linear-gradient(135deg, rgba(32, 201, 151, 0.15), rgba(32, 201, 151, 0.1)); border: 2px solid #20c997; border-radius: 8px; transition: all 0.3s; cursor: pointer;">
                                    <div style="font-size: 2em; margin-bottom: 10px;">üé∞</div>
                                    <h3 style="color: #20c997; font-family: 'Cinzel', serif; margin-bottom: 10px;">
                                        Machine Performance</h3>
                                    <p style="color: rgba(244, 232, 208, 0.8); font-size: 0.9em;">ROI scores, hot
                                        streaks, volatility analysis, and top performers</p>
                                </div>
                            </a>
                        </div>

                        <div class="col-md-6 mb-3">
                            <a href="/analytics/player-patterns" style="text-decoration: none; color: inherit;">
                                <div
                                    style="padding: 25px; background: linear-gradient(135deg, rgba(255, 107, 107, 0.15), rgba(255, 107, 107, 0.1)); border: 2px solid #ff6b6b; border-radius: 8px; transition: all 0.3s; cursor: pointer;">
                                    <div style="font-size: 2em; margin-bottom: 10px;">üìä</div>
                                    <h3 style="color: #ff6b6b; font-family: 'Cinzel', serif; margin-bottom: 10px;">
                                        Player Patterns</h3>
                                    <p style="color: rgba(244, 232, 208, 0.8); font-size: 0.9em;">Best playing times,
                                        weekend vs weekday analysis, temporal heatmaps</p>
                                </div>
                            </a>
                        </div>

                        <div class="col-md-6 mb-3">
                            <a href="/analytics/manufacturer-wars" style="text-decoration: none; color: inherit;">
                                <div
                                    style="padding: 25px; background: linear-gradient(135deg, rgba(138, 43, 226, 0.15), rgba(138, 43, 226, 0.1)); border: 2px solid #8a2be2; border-radius: 8px; transition: all 0.3s; cursor: pointer;">
                                    <div style="font-size: 2em; margin-bottom: 10px;">‚öîÔ∏è</div>
                                    <h3 style="color: #8a2be2; font-family: 'Cinzel', serif; margin-bottom: 10px;">
                                        Manufacturer Wars</h3>
                                    <p style="color: rgba(244, 232, 208, 0.8); font-size: 0.9em;">Market share,
                                        performance comparison, manufacturer rankings</p>
                                </div>
                            </a>
                        </div>

                        <div class="col-md-6 mb-3">
                            <a href="/analytics/game-families" style="text-decoration: none; color: inherit;">
                                <div
                                    style="padding: 25px; background: linear-gradient(135deg, rgba(255, 193, 7, 0.15), rgba(255, 193, 7, 0.1)); border: 2px solid #ffc107; border-radius: 8px; transition: all 0.3s; cursor: pointer;">
                                    <div style="font-size: 2em; margin-bottom: 10px;">üéÆ</div>
                                    <h3 style="color: #ffc107; font-family: 'Cinzel', serif; margin-bottom: 10px;">Game
                                        Families</h3>
                                    <p style="color: rgba(244, 232, 208, 0.8); font-size: 0.9em;">Series performance,
                                        game variants, cross-property analysis</p>
                                </div>
                            </a>
                        </div>

                        <div class="col-md-6 mb-3">
                            <a href="/analytics/jvi-rankings" style="text-decoration: none; color: inherit;">
                                <div
                                    style="padding: 25px; background: linear-gradient(135deg, rgba(0, 255, 159, 0.15), rgba(0, 255, 159, 0.1)); border: 2px solid #00ff9f; border-radius: 8px; transition: all 0.3s; cursor: pointer;">
                                    <div style="font-size: 2em; margin-bottom: 10px;">üíé</div>
                                    <h3 style="color: #00ff9f; font-family: 'Cinzel', serif; margin-bottom: 10px;">JVI
                                        Rankings</h3>
                                    <p style="color: rgba(244, 232, 208, 0.8); font-size: 0.9em;">Jackpot Value Index -
                                        balanced scoring, big payouts, fast hitters</p>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Trends Tab -->
            <div class="tab-pane fade" id="trends">
                <div class="row">
                    <div class="col-md-6">
                        <div class="scroll-card">
                            <h2 class="card-title">üèî Trending in the West</h2>
                            <div class="chart-container"><canvas id="usChart"></canvas></div>
                            {% for item in trending_us %}
                            <a href="https://www.google.com/search?q={{ item.title | urlencode }}" target="_blank"
                                class="data-item">
                                <div class="rank-badge">{{ loop.index }}</div>
                                <div class="trend-text">{{ item.title }}</div>
                            </a>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="scroll-card">
                            <h2 class="card-title">üåç Across All Realms</h2>
                            <div class="chart-container"><canvas id="globalChart"></canvas></div>
                            {% for item in trending_global %}
                            <a href="https://www.google.com/search?q={{ item.title | urlencode }}" target="_blank"
                                class="data-item">
                                <div class="rank-badge">{{ loop.index }}</div>
                                <div class="trend-text">{{ item.title }}</div>
                            </a>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mithril Tab (Crypto) -->
            <div class="tab-pane fade" id="crypto">
                <div class="scroll-card">
                    <h2 class="card-title">‚õèÔ∏è Mithril: Bitcoin & Cryptocurrency</h2>
                    <div class="widget-container">
                        <!-- TradingView Widget BEGIN -->
                        <div class="tradingview-widget-container">
                            <div class="tradingview-widget-container__widget"></div>
                            <script type="text/javascript"
                                src="https://s3.tradingview.com/external-embedding/embed-widget-symbol-overview.js"
                                async>
                                    {
                                        "symbols": [
                                            ["COINBASE:BTCUSD|1D"],
                                            ["COINBASE:ETHUSD|1D"],
                                            ["COINBASE:SOLUSD|1D"],
                                            ["COINBASE:ADAUSD|1D"]
                                        ],
                                            "chartOnly": false,
                                                "width": "100%",
                                                    "height": "600",
                                                        "locale": "en",
                                                            "colorTheme": "dark",
                                                                "autosize": true,
                                                                    "showVolume": false,
                                                                        "showMA": false,
                                                                            "hideDateRanges": false,
                                                                                "hideMarketStatus": false,
                                                                                    "hideSymbolLogo": false,
                                                                                        "scalePosition": "right",
                                                                                            "scaleMode": "Normal",
                                                                                                "fontFamily": "-apple-system, BlinkMacSystemFont, Trebuchet MS, Roboto, Ubuntu, sans-serif",
                                                                                                    "fontSize": "10",
                                                                                                        "noTimeScale": false,
                                                                                                            "valuesTracking": "1",
                                                                                                                "changeMode": "price-and-percent",
                                                                                                                    "chartType": "area",
                                                                                                                        "maLineColor": "#2962FF",
                                                                                                                            "maLineWidth": 1,
                                                                                                                                "maLength": 9,
                                                                                                                                    "backgroundColor": "rgba(19, 23, 34, 0)",
                                                                                                                                        "lineWidth": 2,
                                                                                                                                            "lineType": 0,
                                                                                                                                                "dateRanges": [
                                                                                                                                                    "1d|1",
                                                                                                                                                    "1m|30",
                                                                                                                                                    "3m|60",
                                                                                                                                                    "12m|1D",
                                                                                                                                                    "60m|1W",
                                                                                                                                                    "all|1M"
                                                                                                                                                ]
                                    }
                                </script>
                        </div>
                        <!-- TradingView Widget END -->
                    </div>
                </div>
            </div>

            <!-- Treasures Tab (Fed Treasury) -->
            <div class="tab-pane fade" id="treasury">
                <div class="scroll-card">
                    <h2 class="card-title">üí∞ Treasures: Fed Treasury Data</h2>
                    <div class="widget-container">
                        <!-- TradingView Widget BEGIN -->
                        <div class="tradingview-widget-container">
                            <div class="tradingview-widget-container__widget"></div>
                            <script type="text/javascript"
                                src="https://s3.tradingview.com/external-embedding/embed-widget-market-quotes.js" async>
                                    {
                                        "width": "100%",
                                            "height": "600",
                                                "symbolsGroups": [
                                                    {
                                                        "name": "Treasury Bills",
                                                        "symbols": [
                                                            { "name": "TVC:US01MY", "displayName": "1 Month" },
                                                            { "name": "TVC:US03MY", "displayName": "3 Month" },
                                                            { "name": "TVC:US06MY", "displayName": "6 Month" },
                                                            { "name": "TVC:US01Y", "displayName": "1 Year" }
                                                        ]
                                                    },
                                                    {
                                                        "name": "Treasury Notes",
                                                        "symbols": [
                                                            { "name": "TVC:US02Y", "displayName": "2 Year" },
                                                            { "name": "TVC:US05Y", "displayName": "5 Year" },
                                                            { "name": "TVC:US10Y", "displayName": "10 Year" }
                                                        ]
                                                    },
                                                    {
                                                        "name": "Treasury Bonds",
                                                        "symbols": [
                                                            { "name": "TVC:US20Y", "displayName": "20 Year" },
                                                            { "name": "TVC:US30Y", "displayName": "30 Year" }
                                                        ]
                                                    }
                                                ],
                                                    "showSymbolLogo": true,
                                                        "isTransparent": true,
                                                            "colorTheme": "dark",
                                                                "locale": "en",
                                                                    "backgroundColor": "rgba(19, 23, 34, 0)"
                                    }
                                </script>
                        </div>
                        <!-- TradingView Widget END -->
                    </div>
                </div>
            </div>

            <!-- Markets Tab (Stocks & Economic Indicators) -->
            <div class="tab-pane fade" id="markets">
                <div class="scroll-card">
                    <h2 class="card-title">üèõÔ∏è Markets: NASDAQ & Economic Indicators</h2>
                    <div class="widget-container">
                        <!-- TradingView Widget BEGIN -->
                        <div class="tradingview-widget-container">
                            <div class="tradingview-widget-container__widget"></div>
                            <script type="text/javascript"
                                src="https://s3.tradingview.com/external-embedding/embed-widget-market-overview.js"
                                async>
                                    {
                                        "colorTheme": "dark",
                                            "dateRange": "12M",
                                                "showChart": true,
                                                    "locale": "en",
                                                        "width": "100%",
                                                            "height": "600",
                                                                "largeChartUrl": "",
                                                                    "isTransparent": true,
                                                                        "showSymbolLogo": true,
                                                                            "showFloatingTooltip": false,
                                                                                "plotLineColorGrowing": "rgba(41, 98, 255, 1)",
                                                                                    "plotLineColorFalling": "rgba(41, 98, 255, 1)",
                                                                                        "gridLineColor": "rgba(240, 243, 250, 0)",
                                                                                            "scaleFontColor": "rgba(106, 109, 120, 1)",
                                                                                                "belowLineFillColorGrowing": "rgba(41, 98, 255, 0.12)",
                                                                                                    "belowLineFillColorFalling": "rgba(41, 98, 255, 0.12)",
                                                                                                        "belowLineFillColorGrowingBottom": "rgba(41, 98, 255, 0)",
                                                                                                            "belowLineFillColorFallingBottom": "rgba(41, 98, 255, 0)",
                                                                                                                "symbolActiveColor": "rgba(41, 98, 255, 0.12)",
                                                                                                                    "tabs": [
                                                                                                                        {
                                                                                                                            "title": "Indices",
                                                                                                                            "symbols": [
                                                                                                                                { "s": "NASDAQ:NDX", "d": "NASDAQ 100" },
                                                                                                                                { "s": "SP:SPX", "d": "S&P 500" },
                                                                                                                                { "s": "DJIA:DJI", "d": "Dow Jones" }
                                                                                                                            ],
                                                                                                                            "originalTitle": "Indices"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "title": "Economic",
                                                                                                                            "symbols": [
                                                                                                                                { "s": "ECONOMICS:USIRYY", "d": "Inflation Rate" },
                                                                                                                                { "s": "ECONOMICS:USUNR", "d": "Unemployment" },
                                                                                                                                { "s": "ECONOMICS:USGDPQQ", "d": "GDP Growth" },
                                                                                                                                { "s": "FRED:FEDFUNDS", "d": "Fed Funds Rate" }
                                                                                                                            ],
                                                                                                                            "originalTitle": "Economic"
                                                                                                                        }
                                                                                                                    ]
                                    }
                                </script>
                        </div>
                        <!-- TradingView Widget END -->
                    </div>
                </div>
            </div>

            <!-- News Tab -->
            <div class="tab-pane fade" id="news">
                <div class="scroll-card">
                    <h2 class="card-title">üì∞ Tidings from Afar</h2>
                    {% for article in news_data %}
                    <a href="{{ article.link }}" target="_blank" class="news-item"
                        style="display: block; text-decoration: none; color: inherit;">
                        <div class="news-title">{{ article.title }}</div>
                        <div class="news-source">{{ article.source }} ‚Ä¢ {{ article.published }}</div>
                    </a>
                    {% endfor %}
                </div>
            </div>

            <!-- Links Tab -->
            <div class="tab-pane fade" id="links">
                <div class="row">
                    {% for service in services %}
                    <div class="col-md-6 col-lg-4">
                        <a href="{{ service.url }}" target="_blank" class="service-link">
                            <div class="service-name">{{ service.icon }} {{ service.name }}</div>
                            <div class="service-url">{{ service.url }}</div>
                        </a>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <!-- Casino Jackpots Tab -->
            <div class="tab-pane fade show active" id="jackpots">
                <div class="row">
                    <!-- Daily Oracle Briefing -->
                    <div class="col-12 mb-4">
                        <div class="scroll-card"
                            style="background: linear-gradient(135deg, rgba(138, 43, 226, 0.1), rgba(0, 0, 0, 0.4)); border-color: #8a2be2;">
                            <h2 class="card-title"
                                style="color: #8a2be2; font-size: 1.1em; border-bottom-color: #8a2be2;">üîÆ Daily Oracle
                                Briefing</h2>
                            <div id="oracle-loading"
                                style="text-align: center; color: rgba(244, 232, 208, 0.5); padding: 10px;">
                                <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                                Consulting the stars...
                            </div>
                            <div id="oracle-content"
                                style="font-size: 1.1em; color: var(--parchment); text-align: center; font-style: italic; display: none;">
                            </div>
                        </div>
                    </div>

                    <!-- ü§ñ AI INTELLIGENCE SECTION -->
                    <div class="col-12 mb-4">
                        <div class="scroll-card"
                            style="background: linear-gradient(135deg, rgba(0, 255, 159, 0.1), rgba(0, 0, 0, 0.4)); border-color: #00ff9f;">
                            <h2 class="card-title"
                                style="color: #00ff9f; font-size: 1.1em; border-bottom-color: #00ff9f;">
                                ü§ñ AI Intel: Hot Machines Right Now
                                <button class="btn btn-sm" onclick="refreshHotMachines()"
                                    style="float: right; background: linear-gradient(135deg, rgba(0, 255, 159, 0.3), rgba(0, 255, 159, 0.1)); border: 1px solid #00ff9f; color: #00ff9f; font-family: 'Cinzel', serif; font-size: 0.8em; padding: 4px 12px;">
                                    ‚Üª Refresh
                                </button>
                            </h2>
                            <div
                                style="font-size: 0.8em; color: rgba(244, 232, 208, 0.6); margin-bottom: 15px; text-align: center;">
                                ML-predicted machines with highest win probability ‚Ä¢ Updates every 2 minutes
                            </div>
                            <div id="hot-machines-container">
                                <div style="text-align: center; color: rgba(244, 232, 208, 0.5); padding: 20px;">
                                    <span class="spinner-border spinner-border-sm" role="status"
                                        aria-hidden="true"></span>
                                    Loading AI predictions...
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Column 1: Essentials -->
                    <div class="col-md-4">
                        <div class="scroll-card">
                            <h2 class="card-title">üìä Casino Analytics</h2>

                            <!-- Overall Stats -->
                            <div
                                style="background: linear-gradient(135deg, rgba(212, 175, 55, 0.15), rgba(205, 127, 50, 0.1)); padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                                <div
                                    style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; text-align: center;">
                                    <div>
                                        <div
                                            style="font-size: 1.8em; color: var(--gold); font-family: 'Cinzel', serif;">
                                            ${{ "{:,.2f}".format(stats.avg_jackpot) }}</div>
                                        <div style="font-size: 0.8em; color: rgba(244, 232, 208, 0.7);">Avg Jackpot
                                        </div>
                                    </div>
                                    <div>
                                        <div
                                            style="font-size: 1.8em; color: var(--bronze); font-family: 'Cinzel', serif;">
                                            ${{ "{:,.2f}".format(stats.median_jackpot) }}</div>
                                        <div style="font-size: 0.8em; color: rgba(244, 232, 208, 0.7);">Median</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 1.3em; color: #00ff9f; font-family: 'Cinzel', serif;">${{
                                            "{:,.2f}".format(stats.max_jackpot) }}</div>
                                        <div style="font-size: 0.75em; color: rgba(244, 232, 208, 0.7);">Max Payout
                                        </div>
                                    </div>
                                    <div>
                                        <div
                                            style="font-size: 1.3em; color: var(--parchment); font-family: 'Cinzel', serif;">
                                            {{ "{:,}".format(stats.total_jackpots) }}</div>
                                        <div style="font-size: 0.75em; color: rgba(244, 232, 208, 0.7);">Total Hits
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Activity Tracker -->
                            <div
                                style="background: linear-gradient(135deg, rgba(212, 175, 55, 0.1), rgba(205, 127, 50, 0.05)); padding: 12px; border-radius: 8px; margin-top: 15px;">
                                <h4
                                    style="font-family: 'Cinzel', serif; font-size: 0.95em; color: var(--gold); margin-bottom: 10px; text-align: center;">
                                    üî• Live Activity (15min intervals)</h4>
                                <div style="display: flex; gap: 3px; margin-bottom: 8px;">
                                    {% for activity in stats.activity_by_time %}
                                    {% set max_height = 40 %}
                                    {% set max_count = stats.activity_by_time|map(attribute='count')|max %}
                                    {% set height = (activity.count / max_count * max_height) if max_count > 0 else 5 %}
                                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                        <div
                                            style="width: 100%; background: linear-gradient(to top, var(--gold), var(--bronze)); height: {{ height }}px; border-radius: 2px 2px 0 0; position: relative;">
                                            {% if activity.count > 0 %}
                                            <div
                                                style="position: absolute; top: -18px; left: 50%; transform: translateX(-50%); font-size: 0.7em; color: var(--gold); font-weight: 700; white-space: nowrap;">
                                                {{ activity.count }}</div>
                                            {% endif %}
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                                <div
                                    style="display: flex; justify-content: space-between; font-size: 0.65em; color: rgba(244, 232, 208, 0.6);">
                                    <span>{{ stats.activity_by_time[0].label if stats.activity_by_time else '2h ago'
                                        }}</span>
                                    <span>{{ stats.activity_by_time[-1].label if stats.activity_by_time else 'Now'
                                        }}</span>
                                </div>
                            </div>

                            <!-- Recommended Machines -->
                            <h3
                                style="font-family: 'Cinzel', serif; font-size: 1.1em; color: #00ff9f; margin-top: 20px; margin-bottom: 10px; border-bottom: 2px solid #00ff9f; padding-bottom: 5px;">
                                ‚≠ê PLAY THESE NOW</h3>
                            <p style="font-size: 0.8em; color: rgba(244, 232, 208, 0.6); margin-bottom: 10px;">Best
                                combo of frequency + payout</p>
                            {% for rec in stats.recommended[:5] %}
                            <div
                                style="padding: 10px; margin: 8px 0; background: linear-gradient(90deg, rgba(0, 255, 159, 0.15), rgba(0, 255, 159, 0.05)); border-left: 4px solid #00ff9f; border-radius: 4px;">
                                <div style="margin-bottom: 5px;">
                                    <a href="/machine/{{ rec.machine_name }}"
                                        style="color: #00ff9f; font-weight: 700; font-size: 0.95em; text-decoration: none; border-bottom: 1px dotted #00ff9f;">{{
                                        rec.machine_name[:35] }}</a>
                                </div>
                                <div style="display: flex; justify-content: space-between; font-size: 0.85em;">
                                    <span style="color: rgba(244, 232, 208, 0.9);">{{ rec.denomination }}</span>
                                    <span style="color: var(--gold); font-weight: 700;">Avg: ${{
                                        "{:,.2f}".format(rec.avg_payout) }}</span>
                                </div>
                                <div style="font-size: 0.75em; color: rgba(244, 232, 208, 0.7); margin-top: 3px;">{{
                                    "{:,}".format(rec.hit_count) }} hits ‚Ä¢ Max: ${{ "{:,.2f}".format(rec.max_payout) }}
                                </div>
                            </div>
                            {% endfor %}

                        </div>
                    </div>
                    <!-- Column 2: Segments & Analytics -->
                    <div class="col-md-4">
                        <div class="scroll-card">
                            <h2 class="card-title">üîç Market Segments</h2>

                            <!-- High Limit Room -->
                            <div
                                style="background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 215, 0, 0.05)); padding: 15px; border-radius: 8px; margin-bottom: 25px; border: 2px solid gold;">
                                <h3
                                    style="font-family: 'Cinzel', serif; font-size: 1.2em; color: gold; margin-bottom: 5px; text-align: center; text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);">
                                    üëë HIGH LIMIT ROOM üëë</h3>
                                <p
                                    style="font-size: 0.75em; color: rgba(244, 232, 208, 0.8); text-align: center; margin-bottom: 15px;">
                                    HD Floor Location ‚Ä¢ <a href="/zone/HD"
                                        style="color: #00ff9f; text-decoration: underline;">View Report</a>
                                </p>

                                <div
                                    style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; text-align: center; margin-bottom: 15px;">
                                    <div>
                                        <div style="font-size: 1.3em; color: gold; font-family: 'Cinzel', serif;">{{
                                            "{:,}".format(stats.high_limit.count) }}</div>
                                        <div style="font-size: 0.7em; color: rgba(244, 232, 208, 0.7);">Total Hits</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 1.3em; color: gold; font-family: 'Cinzel', serif;">${{
                                            "{:,.0f}".format(stats.high_limit.avg) }}</div>
                                        <div style="font-size: 0.7em; color: rgba(244, 232, 208, 0.7);">Avg Payout</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 1.3em; color: #00ff9f; font-family: 'Cinzel', serif;">${{
                                            "{:,.0f}".format(stats.high_limit.max) }}</div>
                                        <div style="font-size: 0.7em; color: rgba(244, 232, 208, 0.7);">Max Hit</div>
                                    </div>
                                </div>

                                {% if stats.high_limit.recommended %}
                                <h4
                                    style="font-size: 0.9em; color: gold; margin-top: 15px; margin-bottom: 8px; border-bottom: 1px solid gold; padding-bottom: 3px;">
                                    ‚≠ê Best High-Limit Machines</h4>
                                {% for hl in stats.high_limit.recommended[:3] %}
                                <div
                                    style="padding: 8px; margin: 5px 0; background: linear-gradient(90deg, rgba(255, 215, 0, 0.15), rgba(255, 215, 0, 0.05)); border-left: 3px solid gold; border-radius: 3px;">
                                    <div style="margin-bottom: 3px;">
                                        <a href="/machine/{{ hl.machine_name }}"
                                            style="color: gold; fontWeight: 700; fontSize: 0.8em; text-decoration: none; border-bottom: 1px dotted gold;">{{
                                            hl.machine_name[:30] }}</a>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; font-size: 0.75em;">
                                        <span style="color: rgba(244, 232, 208, 0.8);">{{ hl.denomination }}</span>
                                        <span style="color: #00ff9f; font-weight: 700;">${{
                                            "{:,.0f}".format(hl.avg_payout) }}</span>
                                    </div>
                                    <div style="font-size: 0.7em; color: rgba(244, 232, 208, 0.6); margin-top: 2px;">{{
                                        "{:,}".format(hl.hit_count) }} hits ‚Ä¢ Max: ${{ "{:,.0f}".format(hl.max_payout)
                                        }}</div>
                                </div>
                                {% endfor %}
                                {% endif %}
                            </div>

                            <!-- Regular Floor Stats -->
                            <div
                                style="background: linear-gradient(135deg, rgba(32, 201, 151, 0.2), rgba(32, 201, 151, 0.05)); padding: 15px; border-radius: 8px; margin-top: 25px; border: 2px solid #20c997;">
                                <h3
                                    style="font-family: 'Cinzel', serif; font-size: 1.2em; color: #20c997; margin-bottom: 5px; text-align: center; text-shadow: 0 0 10px rgba(32, 201, 151, 0.5);">
                                    üé∞ REGULAR FLOOR üé∞</h3>
                                <p
                                    style="font-size: 0.75em; color: rgba(244, 232, 208, 0.8); text-align: center; margin-bottom: 15px;">
                                    All Non-HD Locations ‚Ä¢ Regular Floor Machines
                                </p>

                                <div
                                    style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; text-align: center; margin-bottom: 15px;">
                                    <div>
                                        <div style="font-size: 1.3em; color: #20c997; font-family: 'Cinzel', serif;">{{
                                            "{:,}".format(stats.regular_floor.count) if stats.regular_floor and
                                            stats.regular_floor.count else '0' }}</div>
                                        <div style="font-size: 0.7em; color: rgba(244, 232, 208, 0.7);">Total Hits</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 1.3em; color: #20c997; font-family: 'Cinzel', serif;">${{
                                            "{:,.0f}".format(stats.regular_floor.avg) if stats.regular_floor and
                                            stats.regular_floor.avg else '0' }}</div>
                                        <div style="font-size: 0.7em; color: rgba(244, 232, 208, 0.7);">Avg Payout</div>
                                    </div>
                                    <div>
                                        <div
                                            style="font-size: 1.3em; color: var(--gold); font-family: 'Cinzel', serif;">
                                            ${{ "{:,.0f}".format(stats.regular_floor.max) if stats.regular_floor and
                                            stats.regular_floor.max else '0' }}</div>
                                        <div style="font-size: 0.7em; color: rgba(244, 232, 208, 0.7);">Max Hit</div>
                                    </div>
                                </div>

                                {% if stats.regular_floor and stats.regular_floor.recommended %}
                                <h4
                                    style="font-size: 0.9em; color: #20c997; margin-top: 15px; margin-bottom: 8px; border-bottom: 1px solid #20c997; padding-bottom: 3px;">
                                    ‚≠ê Best Regular Floor Machines</h4>
                                {% for rf in stats.regular_floor.recommended[:3] %}
                                <div
                                    style="padding: 8px; margin: 5px 0; background: linear-gradient(90deg, rgba(32, 201, 151, 0.15), rgba(32, 201, 151, 0.05)); border-left: 3px solid #20c997; border-radius: 3px;">
                                    <div style="margin-bottom: 3px;">
                                        <a href="/machine/{{ rf.machine_name }}"
                                            style="color: #20c997; font-weight: 700; font-size: 0.8em; text-decoration: none; border-bottom: 1px dotted #20c997;">{{
                                            rf.machine_name[:30] }}</a>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; font-size: 0.75em;">
                                        <span style="color: rgba(244, 232, 208, 0.8);">{{ rf.denomination }}</span>
                                        <span style="color: var(--gold); font-weight: 700;">${{
                                            "{:,.0f}".format(rf.avg_payout) }}</span>
                                    </div>
                                    <div style="font-size: 0.7em; color: rgba(244, 232, 208, 0.6); margin-top: 2px;">{{
                                        "{:,}".format(rf.hit_count) }} hits ‚Ä¢ Max: ${{ "{:,.0f}".format(rf.max_payout)
                                        }}</div>
                                </div>
                                {% endfor %}
                                {% endif %}
                            </div>

                            <!-- Hourly Trends -->
                            <h3
                                style="font-family: 'Cinzel', serif; font-size: 1.1em; color: var(--gold); margin-top: 25px; margin-bottom: 15px;">
                                üïò Hourly Activity Volume</h3>
                            <div id="hourly-chart"
                                style="display: flex; align-items: flex-end; height: 100px; gap: 2px; margin-bottom: 25px; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                {% for h in hourly %}
                                <div title="{{ h.hits }} hits at {{ h.hour }}:00"
                                    style="flex: 1; background: {% if h.hits > 300 %}var(--accent){% else %}var(--bronze){% endif %}; 
                                            height: {{ (h.hits / 500 * 100)|int }}%; opacity: 0.8; border-radius: 2px 2px 0 0;"></div>
                                {% endfor %}
                            </div>

                            <!-- Anomaly Detection -->
                            <h3 style="font-size: 1.1em; color: #ff6b6b; margin-bottom: 15px;">üö® Anomalies (Outliers)
                            </h3>
                            <div id="outliers-list" style="max-height: 300px; overflow-y: auto;">
                                {% for o in outliers %}
                                <div
                                    style="background: rgba(255,0,0,0.1); border-left: 3px solid #ff4444; padding: 10px; margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between;">
                                        <a href="/machine/{{ o.machine_name }}"
                                            style="font-weight: bold; font-size: 0.9em; color: #fff; text-decoration: none;">{{
                                            o.machine_name }}</a>
                                        <span class="badge bg-danger">Z: {{ o.z_score }}</span>
                                    </div>
                                    <div
                                        style="display: flex; justify-content: space-between; margin-top: 5px; font-size: 0.8em;">
                                        <span style="color: var(--accent);">${{ "{:,.2f}".format(o.amount) }}</span>
                                        <span class="text-muted">{{ o.hit_timestamp.strftime('%m/%d %I:%M%p') }}</span>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>

                        </div>
                    </div>
                    <!-- Column 3: Strategy & Best Times -->
                    <div class="col-md-4">
                        <div class="scroll-card">
                            <h2 class="card-title">‚öîÔ∏è Strategic Warfare</h2>

                            <!-- Best Time to Play (Moved here, 24h list) -->
                            <h3
                                style="font-family: 'Cinzel', serif; font-size: 1.1em; color: var(--gold); margin-bottom: 10px; border-bottom: 1px solid var(--bronze); padding-bottom: 5px;">
                                ‚è∞ Best Time to Play (All-Time)</h3>
                            <p style="font-size: 0.75em; color: rgba(244, 232, 208, 0.6); margin-bottom: 10px;">Based on
                                all historical jackpot frequency</p>
                            <div style="max-height: 400px; overflow-y: auto; margin-bottom: 25px; padding-right: 5px;">
                                {% for hour in stats.best_hours %}
                                <div
                                    style="padding: 8px; margin: 4px 0; background: linear-gradient(90deg, rgba(212, 175, 55, 0.1), rgba(205, 127, 50, 0.05)); border-left: 3px solid var(--gold); display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <div style="color: var(--gold); font-weight: 700; font-size: 0.9em;">{{
                                            hour.time }}</div>
                                        <div style="color: rgba(244, 232, 208, 0.7); font-size: 0.75em;">{{ hour.hits }}
                                            hits</div>
                                    </div>
                                    <div style="color: var(--bronze); font-size: 0.85em;">${{
                                        "%.0f"|format(hour.avg_payout) }}</div>
                                </div>
                                {% endfor %}
                            </div>

                            <!-- Zone Analysis -->
                            <h4
                                style="font-size: 0.95em; color: var(--parchment); margin-bottom: 10px; border-left: 3px solid var(--bronze); padding-left: 8px;">
                                üìç Zone Control</h4>
                            <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 20px;">
                                {% for zone in stats.zones %}
                                <a href="/zone/{{ zone.zone }}"
                                    style="text-decoration: none; color: inherit; flex: 1; min-width: 45%;">
                                    <div
                                        style="background: rgba(0, 0, 0, 0.3); padding: 8px; border-radius: 4px; border: 1px solid rgba(212, 175, 55, 0.2); transition: all 0.2s;">
                                        <div
                                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                                            <span style="color: var(--gold); font-weight: 700;">{{ zone.zone }} {% if
                                                zone.zone == 'HD' %}(Hi-Lim){% endif %}</span>
                                            <span style="font-size: 0.8em; color: rgba(244, 232, 208, 0.6);">{{
                                                zone.hits }} hits</span>
                                        </div>
                                        <div style="font-size: 0.8em; color: var(--bronze);">Avg: ${{
                                            "%.0f"|format(zone.avg_payout) }}</div>
                                    </div>
                                </a>
                                {% endfor %}
                            </div>

                            <!-- Regular Zone Analysis -->
                            <h4
                                style="font-size: 0.95em; color: var(--parchment); margin-bottom: 10px; border-left: 3px solid #00ff9f; padding-left: 8px;">
                                üìç Regular Floor (No High-Limit)</h4>
                            <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 20px;">
                                {% for zone in stats.zones_regular %}
                                <a href="/zone/{{ zone.zone }}"
                                    style="text-decoration: none; color: inherit; flex: 1; min-width: 45%;">
                                    <div
                                        style="background: rgba(0, 0, 0, 0.3); padding: 8px; border-radius: 4px; border: 1px solid rgba(0, 255, 159, 0.2); transition: all 0.2s;">
                                        <div
                                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                                            <span style="color: #00ff9f; font-weight: 700;">{{ zone.zone }}</span>
                                            <span style="font-size: 0.8em; color: rgba(244, 232, 208, 0.6);">{{
                                                zone.hits }} hits</span>
                                        </div>
                                        <div style="font-size: 0.8em; color: var(--bronze);">Avg: ${{
                                            "%.0f"|format(zone.avg_payout) }}</div>
                                    </div>
                                </a>
                                {% endfor %}
                            </div>

                            <!-- Brand Wars -->
                            <h4
                                style="font-size: 0.95em; color: var(--parchment); margin-bottom: 10px; border-left: 3px solid var(--bronze); padding-left: 8px;">
                                üêÇ Battle of Brands</h4>
                            {% for family in stats.game_families %}
                            <a href="/brand/{{ family.family }}"
                                style="text-decoration: none; color: inherit; display: block;">
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; padding: 6px 0; border-bottom: 1px solid rgba(212, 175, 55, 0.1);">
                                    <span style="color: rgba(244, 232, 208, 0.8); font-size: 0.9em;">{{ family.family
                                        }}</span>
                                    <div style="text-align: right;">
                                        <div style="color: var(--gold); font-size: 0.85em; font-weight: 700;">${{
                                            "{:,.0f}".format(family.avg_payout) }}</div>
                                        <div style="color: rgba(244, 232, 208, 0.5); font-size: 0.75em;">{{
                                            "{:,}".format(family.hits) }} hits</div>
                                    </div>
                                </div>
                            </a>
                            {% endfor %}

                            <!-- Manufacturing War -->
                            <h4
                                style="font-size: 0.95em; color: var(--accent); margin-top: 20px; margin-bottom: 10px; border-left: 3px solid var(--accent); padding-left: 8px;">
                                ‚öîÔ∏è Clash of Manufacturers</h4>
                            {% for mfg in stats.manufacturers %}
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; padding: 6px 0; border-bottom: 1px solid rgba(32, 201, 151, 0.2);">
                                <span style="color: rgba(244, 232, 208, 0.9); font-size: 0.9em; font-weight: bold;">{{
                                    mfg.name }}</span>
                                <div style="text-align: right;">
                                    <div style="color: var(--accent); font-size: 0.85em; font-weight: 700;">${{
                                        "{:,.0f}".format(mfg.total) }}</div>
                                    <div style="color: rgba(244, 232, 208, 0.5); font-size: 0.75em;">{{
                                        "{:,}".format(mfg.hits) }} hits | Avg: ${{ "{:,.0f}".format(mfg.avg) }}</div>
                                </div>
                            </div>
                            {% endfor %}

                            <!-- Sleeping Giants -->
                            {% if stats.cold_machines %}
                            <h4
                                style="font-size: 0.95em; color: #ff6b6b; margin-top: 20px; margin-bottom: 10px; border-left: 3px solid #ff6b6b; padding-left: 8px;">
                                üßä Sleeping Giants (Due?)</h4>
                            {% for machine in stats.cold_machines %}
                            <div
                                style="padding: 8px; margin: 5px 0; background: linear-gradient(90deg, rgba(255, 107, 107, 0.1), rgba(255, 107, 107, 0.02)); border-left: 3px solid #ff6b6b;">
                                <div style="color: rgba(244, 232, 208, 0.9); font-size: 0.85em; margin-bottom: 3px;">{{
                                    machine.machine_name[:30] }}...</div>
                                <div style="display: flex; justify-content: space-between; font-size: 0.75em;">
                                    <span style="color: #ff6b6b;">Cold for: {{ machine.time_since }}</span>
                                    <span style="color: rgba(244, 232, 208, 0.5);">{{ machine.historic_hits }} past
                                        hits</span>
                                </div>
                            </div>
                            {% endfor %}
                            {% endif %}

                            <!-- Best Payouts -->
                            <h3
                                style="font-family: 'Cinzel', serif; font-size: 1.1em; color: var(--gold); margin-top: 20px; margin-bottom: 10px; border-bottom: 1px solid var(--bronze); padding-bottom: 5px;">
                                <a href="/payouts"
                                    style="color: inherit; text-decoration: none; display: flex; align-items: center; justify-content: space-between;">
                                    <span>üí∞ Highest Avg Payouts</span>
                                    <span style="font-size: 0.7em; opacity: 0.7;">View Top 100 ‚Üí</span>
                                </a>
                            </h3>
                            {% for machine in stats.best_machines[:5] %}
                            <div
                                style="padding: 8px; margin: 5px 0; background: linear-gradient(90deg, rgba(212, 175, 55, 0.1), rgba(205, 127, 50, 0.05)); border-left: 3px solid var(--gold);">
                                <div style="margin-bottom: 3px;">
                                    <a href="/machine/{{ machine.machine_name }}"
                                        style="color: var(--parchment); font-size: 0.85em; text-decoration: none;">{{
                                        machine.machine_name[:30] }}...</a>
                                </div>
                                <div style="display: flex; justify-content: space-between; font-size: 0.8em;">
                                    <span style="color: rgba(244, 232, 208, 0.7);">{{ machine.denomination }}</span>
                                    <span style="color: var(--gold); font-weight: 700;">${{
                                        "%.2f"|format(machine.avg_payout) }}</span>
                                </div>
                            </div>
                            {% endfor %}

                            <!-- Hot Machines (Most Frequent) -->
                            <h3
                                style="font-family: 'Cinzel', serif; font-size: 1.1em; color: var(--gold); margin-top: 20px; margin-bottom: 10px; border-bottom: 1px solid var(--bronze); padding-bottom: 5px;">
                                <a href="/hottest"
                                    style="color: inherit; text-decoration: none; display: flex; align-items: center; justify-content: space-between;">
                                    <span>üî• Hottest Machines</span>
                                    <span style="font-size: 0.7em; opacity: 0.7;">View All ‚Üí</span>
                                </a>
                            </h3>
                            {% for machine in stats.top_machines[:5] %}
                            <div
                                style="padding: 8px; margin: 5px 0; background: linear-gradient(90deg, rgba(212, 175, 55, 0.1), rgba(205, 127, 50, 0.05)); border-left: 3px solid var(--gold);">
                                <div
                                    style="color: {{ machine.color|default('#ffffff') }}; font-weight: bold; font-size: 0.85em; margin-bottom: 3px;">
                                    {{ machine.machine_name[:30] }}...</div>
                                <div style="display: flex; justify-content: space-between; font-size: 0.8em;">
                                    <span style="color: var(--bronze);">{{ machine.hit_count }} hits</span>
                                    <span style="color: var(--gold);">Avg: ${{ "%.2f"|format(machine.avg_payout)
                                        }}</span>
                                </div>
                            </div>
                            {% endfor %}

                            <!-- Best Denominations -->
                            <h3
                                style="font-family: 'Cinzel', serif; font-size: 1.1em; color: var(--gold); margin-top: 20px; margin-bottom: 10px; border-bottom: 1px solid var(--bronze); padding-bottom: 5px;">
                                üíµ Best Bet Sizes</h3>
                            {% for denom in stats.top_denoms[:5] %}
                            <a href="/denom/{{ denom.denomination }}"
                                style="text-decoration: none; color: inherit; display: block;">
                                <div
                                    style="padding: 8px; margin: 5px 0; background: linear-gradient(90deg, rgba(212, 175, 55, 0.1), rgba(205, 127, 50, 0.05)); border-left: 3px solid var(--gold); display: flex; justify-content: space-between;">
                                    <span style="color: var(--parchment);">{{ denom.denomination }}</span>
                                    <span style="color: var(--gold); font-weight: 700;">${{
                                        "%.2f"|format(denom.avg_payout) }}</span>
                                </div>
                            </a>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>


    </div>

    <div class="footer">
        <div><span>‚öî</span> <span>SYSTEM ONLINE</span></div>
        <div style="color: var(--gold); font-family: 'Cinzel', serif;">üìú Analyzing {{ stats.total_jackpots }} Data
            Points</div>
        <div><span>Last Updated: {{ update_time }}</span></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Fetch Daily Briefing
        fetch('/api/daily-briefing')
            .then(response => response.json())
            .then(data => {
                document.getElementById('oracle-loading').style.display = 'none';
                const content = document.getElementById('oracle-content');
                content.innerText = '"' + data.briefing + '"';
                content.style.display = 'block';
            })
            .catch(err => {
                document.getElementById('oracle-loading').innerText = 'The Oracle is silent today.';
            });

        // Smart Search Handler
        document.getElementById('smartSearch').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                const query = this.value;
                this.placeholder = "Thinking...";
                this.disabled = true;

                fetch(`/api/smart-search?q=${encodeURIComponent(query)}`)
                    .then(response => response.json())
                    .then(data => {
                        console.log("Oracle Filters:", data);
                        alert("Oracle Logic Extracted:\n" + JSON.stringify(data, null, 2));
                        this.value = "";
                        this.placeholder = "üîÆ Ask the Oracle...";
                        this.disabled = false;
                    });
            }
        });

        // ü§ñ AI Hot Machines Integration
        async function refreshHotMachines() {
            const container = document.getElementById('hot-machines-container');

            try {
                const response = await fetch('http://localhost:8000/ai/hot-machines?limit=10');
                const data = await response.json();

                if (data.count === 0 || !data.machines || data.machines.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; color: rgba(244, 232, 208, 0.6); padding: 30px;">
                            <div style="font-size: 3em; margin-bottom: 10px;">‚ùÑÔ∏è</div>
                            <div style="font-size: 1.1em; margin-bottom: 5px;">No Hot Machines Detected</div>
                            <div style="font-size: 0.85em; color: rgba(244, 232, 208, 0.4);">
                                This is normal ‚Äì most machines are cold most of the time.<br>
                                Check back later or play your favorites!
                            </div>
                        </div>
                    `;
                    return;
                }

                // Display machines in a grid
                let html = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;">';

                data.machines.forEach((machine, index) => {
                    const score = Math.round(machine.combined_score * 100);
                    const emoji = index === 0 ? 'üî•' : index === 1 ? '‚≠ê' : 'üìä';
                    const borderColor = score >= 70 ? '#ff4444' : score >= 55 ? '#00ff9f' : '#ffc107';

                    html += `
                        <div style="
                            background: linear-gradient(135deg, rgba(0, 255, 159, 0.1), rgba(0, 255, 159, 0.02));
                            border-left: 4px solid ${borderColor};
                            padding: 15px;
                            border-radius: 8px;
                            transition: all 0.3s;
                            cursor: pointer;
                        " onmouseover="this.style.transform='translateX(5px)'; this.style.boxShadow='0 5px 20px rgba(0, 255, 159, 0.3)';"
                           onmouseout="this.style.transform=''; this.style.boxShadow='';">
                            
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                                <div style="flex: 1;">
                                    <div style="color: #00ff9f; font-weight: 700; font-size: 0.95em; font-family: 'Cinzel', serif; margin-bottom: 5px;">
                                        ${emoji} ${machine.machine_id.substring(0, 35)}${machine.machine_id.length > 35 ? '...' : ''}
                                    </div>
                                    <div style="font-size: 0.75em; color: rgba(244, 232, 208, 0.6);">
                                        Rank #${index + 1}
                                    </div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-size: 1.8em; color: var(--gold); font-family: 'Cinzel', serif; font-weight: 900;">
                                        ${score}
                                    </div>
                                    <div style="font-size: 0.7em; color: rgba(244, 232, 208, 0.5);">Score</div>
                                </div>
                            </div>
                            
                            <div style="font-size: 0.85em; color: rgba(244, 232, 208, 0.8); margin-bottom: 8px;">
                                ${machine.final_recommendation || 'Analyzing...'}
                            </div>
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.75em;">
                                <div>
                                    <span style="color: rgba(244, 232, 208, 0.5);">Status:</span>
                                    <span style="color: ${machine.ml_classification === 'HOT' ? '#ff4444' : '#ffc107'}; font-weight: 700;">
                                        ${machine.ml_classification || 'UNKNOWN'}
                                    </span>
                                </div>
                                <div style="text-align: right;">
                                    <span style="color: rgba(244, 232, 208, 0.5);">ETA:</span>
                                    <span style="color: var(--bronze); font-weight: 700;">
                                        ~${machine.ml_predicted_minutes ? Math.round(machine.ml_predicted_minutes / 60) : '?'} hrs
                                    </span>
                                </div>
                            </div>
                        </div>
                    `;
                });

                html += '</div>';
                container.innerHTML = html;

            } catch (error) {
                console.error('Error loading hot machines:', error);
                container.innerHTML = `
                    <div style="text-align: center; color: #ff6b6b; padding: 20px;">
                        <div style="font-size: 2em; margin-bottom: 10px;">‚ö†Ô∏è</div>
                        <div>AI System Unavailable</div>
                        <div style="font-size: 0.8em; color: rgba(244, 232, 208, 0.5); margin-top: 5px;">
                            ${error.message || 'Connection error'}
                        </div>
                    </div>
                `;
            }
        }

        // Load hot machines on page load
        refreshHotMachines();

        // Auto-refresh every 2 minutes
        setInterval(refreshHotMachines, 120000);

        // Charts removed in new layout
        setTimeout(() => location.reload(), 300000);
        let timeLeft = 300;
        setInterval(() => { timeLeft--; if (timeLeft <= 0) timeLeft = 300; const m = Math.floor(timeLeft / 60), s = timeLeft % 60; document.title = `‚öî The One Dashboard (${m}:${s.toString().padStart(2, '0')})`; }, 1000);
    </script>
</body>

</html>