<!DOCTYPE html>
<html>

<head>
    <title>Jackpot Forecast</title>
    <!-- Styles included via base template or assumed global if linked -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/css/dashboard.css" rel="stylesheet">
    <script src="https://cdn.plot.ly/plotly-2.35.0.min.js"></script>
</head>

<body>
    <div class="container">
        <a href="/" class="back-btn"
            style="text-decoration: none; color: var(--bronze); font-size: 0.9em; display: inline-block; margin-bottom: 20px;">‚Üê
            Back to Dashboard</a>
        <h1 class="text-center mb-4" style="color: var(--gold);">üìà 30-Day Jackpot Forecast</h1>
        <p class="text-center" style="color: #888; margin-bottom: 30px;">
            Powered by Facebook Prophet - Time Series Forecasting
        </p>

        <div style="background: rgba(26, 26, 26, 0.95); padding: 20px; border-radius: 8px;">
            <div id="forecast-chart" style="width: 100%; height: 600px;"></div>
        </div>

        <div class="card p-4 mt-4" style="background: rgba(26,26,26,0.95); border: 1px solid #444;">
            <h3 style="color: var(--gold);">üìä Forecast Insights</h3>
            <ul style="color: #aaa;">
                <li><strong>Blue Line:</strong> Predicted daily jackpot count</li>
                <li><strong>Shaded Area:</strong> 95% confidence interval</li>
                <li><strong>Black Dots:</strong> Historical actual data</li>
                <li><strong>Seasonality:</strong> Weekly and monthly patterns detected</li>
            </ul>
        </div>
    </div>

    <script>
        const data = {{ forecast_data| tojson }};

        const traces = [
            {
                x: data.dates,
                y: data.predicted,
                mode: 'lines',
                name: 'Forecast',
                line: { color: '#4dabf7', width: 3 }
            },
            {
                x: data.dates,
                y: data.upper,
                mode: 'lines',
                name: 'Upper Bound',
                line: { width: 0 },
                showlegend: false
            },
            {
                x: data.dates,
                y: data.lower,
                mode: 'lines',
                name: 'Lower Bound',
                fill: 'tonexty',
                fillcolor: 'rgba(77, 171, 247, 0.2)',
                line: { width: 0 },
                showlegend: false
            },
            {
                x: data.dates.slice(0, data.actual.filter(x => x !== null).length),
                y: data.actual.filter(x => x !== null),
                mode: 'markers',
                name: 'Actual',
                marker: { color: '#fff', size: 6 } /* Changed to white for visibility on dark theme */
            }
        ];

        const layout = {
            title: {
                text: 'Daily Jackpot Count Forecast',
                font: { color: '#d4af37', size: 20 }
            },
            xaxis: {
                title: 'Date',
                gridcolor: 'rgba(255,255,255,0.1)',
                color: '#aaa',
                tickfont: { color: '#aaa' }
            },
            yaxis: {
                title: 'Jackpot Count',
                gridcolor: 'rgba(255,255,255,0.1)',
                color: '#aaa',
                tickfont: { color: '#aaa' }
            },
            plot_bgcolor: 'rgba(26,26,26,0.5)',
            paper_bgcolor: 'rgba(26,26,26,0)',
            font: { color: '#f4e8d0' },
            legend: { bgcolor: 'rgba(26,26,26,0.8)', font: { color: '#ccc' } }
        };

        Plotly.newPlot('forecast-chart', traces, layout, { responsive: true });
    </script>
</body>

</html>